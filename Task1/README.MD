Задача 1 я думаю должна делаться через хэш-таблицу

Идем по обеим строкам, заполняем все P, дополнительно заполняем хеш таблицу вида : символ из второй строки - количество раз, когда он не P

Потом идем по первой строке и заполняем S по таблице, остальные I
